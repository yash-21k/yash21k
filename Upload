import json
import sys
import os
from typing import Any

def pretty_print(data: Any, indent: int = 2):
    """Pretty print any data."""
    print(json.dumps(data, indent=indent, ensure_ascii=False))

def find_messages_fields(data: Any, path='root'):
    """Recursively find and print all 'messages' fields."""
    if isinstance(data, dict):
        for key, value in data.items():
            if key == "messages":
                print(f"\nFound 'messages' at path: {path} ‚Üí {key}")
                pretty_print(value)
            find_messages_fields(value, path + f" ‚Üí {key}")
    elif isinstance(data, list):
        for index, item in enumerate(data):
            find_messages_fields(item, path + f"[{index}]")

def read_json_file(filepath: str) -> Any:
    """Read a JSON file and return its content."""
    if not os.path.isfile(filepath):
        print(f"‚ùå File not found: {filepath}")
        sys.exit(1)
    try:
        with open(filepath, "r", encoding="utf-8") as f:
            return json.load(f)
    except json.JSONDecodeError as e:
        print(f"‚ùå Error parsing JSON: {e}")
        sys.exit(1)

def main():
    if len(sys.argv) < 2:
        print("Usage: python print_messages_from_json.py <path_to_json_file>")
        sys.exit(1)

    filepath = sys.argv[1]
    data = read_json_file(filepath)
    print("üîç Searching for 'messages' fields...")
    find_messages_fields(data)

if __name__ == "__main__":
    main()